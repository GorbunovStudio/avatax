<?xml version="1.0" encoding="UTF-8"?>
<!--
/**
 * OnePica_AvaTax
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Open Software License (OSL 3.0), a
 * copy of which is available through the world-wide-web at this URL:
 * http://opensource.org/licenses/osl-3.0.php
 *
 * @category   OnePica
 * @package    OnePica_AvaTax
 * @author     OnePica Codemaster <codemaster@onepica.com>
 * @copyright  Copyright (c) 2009 One Pica, Inc.
 * @license    http://opensource.org/licenses/osl-3.0.php Open Software License (OSL 3.0)
 */
-->
<layout>
    <checkout_cart_index>
        <update handle="avataxar2_cert_additional_scripts" />
    </checkout_cart_index>

    <checkout_onepage_index>
        <update handle="avataxar2_cert_additional_scripts" />
    </checkout_onepage_index>

    <avataxar2_popup_gencert>
        <reference name="root">
            <remove name="header" />
            <remove name="footer" />
            <remove name="global_notices" />
            <remove name="global_messages" />
            <remove name="messages" />
            <action method="setTemplate">
                <template>page/1column.phtml</template>
            </action>
        </reference>
        <update handle="avataxar2_cert_additional_scripts" />
        <reference name="content">
            <block type="avataxar2/popup_form" name="avataxar2.popup.form" template="onepica/avataxar2/popup/form.phtml" />
        </reference>
    </avataxar2_popup_gencert>

    <customer_account>
        <reference name="customer_account_navigation">
            <action method="addLink">
                <name>avataxar2_documents_grid</name>
                <path>avataxar2/documents/grid</path>
                <label>AvaTax Documents</label>
            </action>
        </reference>
    </customer_account>

    <avataxar2_documents_grid>
        <update handle="customer_account" />
        <reference name="my.account.wrapper">
            <block type="avataxar2/documents_grid" name="avataxar2.documents.grid" template="onepica/avataxar2/documents/grid.phtml">
                <block type="avataxar2/documents_grid_form" name="avataxar2.documents.grid.form" template="onepica/avataxar2/documents/grid/form.phtml" />
            </block>
        </reference>
    </avataxar2_documents_grid>

    <!-- Cert additional scripts -->
    <avataxar2_cert_additional_scripts>
        <reference name="head">
            <action method="addItem" ifconfig="tax/avatax_document_management/action">
                <type>js</type>
                <name>avatax/certcapture.js</name>
            </action>
            <action method="addItem" ifconfig="tax/avatax_document_management/action">
                <type>js_css</type>
                <name>avatax/themes/certcapture.css</name>
            </action>
            <action method="addItem" ifconfig="tax/avatax_document_management/action">
                <type>js</type>
                <name>prototype/window.js</name>
                <params />
            </action>
            <action method="addItem" ifconfig="tax/avatax_document_management/action">
                <type>js_css</type>
                <name>prototype/windows/themes/default.css</name>
            </action>
        </reference>
    </avataxar2_cert_additional_scripts>
</layout>
